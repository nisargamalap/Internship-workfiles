{% extends 'base.html' %}
{% load static %}

{% block title %}Annual Reports - UDAAN Society{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/annual_reports.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
{% endblock %}

{% block content %}
<!-- Hero Section -->
<section class="hero-section" style="background-image: url('https://udaansociety.org/static/assets/img/hero-bg.jpg');">
    <div class="hero-content">
        <h1>Annual Reports</h1>
        <p>Transparency and Accountability in our journey.</p>
    </div>
</section>

<!-- Breadcrumbs -->
<div class="container breadcrumbs">
    <p><a href="{% url 'home' %}">Home</a> > <span class="current">Annual Reports</span></p>
</div>

<!-- Main Content -->
<div class="main-content container">

    <div class="section-title">
        <h2>ANNUAL <span>REPORTS</span></h2>
        <p>A course or principle of action proposed by UDAAN Society.</p>
    </div>

    <!-- Report Viewer -->
    <div class="report-viewer-wrapper" id="reportViewer">

        <!-- Year Tabs - Generated from Database -->
        <div class="year-tabs">
            {% for report in reports %}
            <div class="year-tab {% if foorloop.first %}active{% endif %}"
                data-year="{{ report.title|cut:'Annual Report ' }}" data-file="{{ report.file.url }}">
                {{ report.title|cut:'Annual Report ' }}
            </div>
            {% endfor %}
        </div>

        <!-- Toolbar -->
        <div class="viewer-toolbar">
            <div class="toolbar-group">
                <button class="toolbar-btn" id="prevBtn" title="Previous Page">
                    <i class="fas fa-chevron-left"></i>
                </button>

                <div class="page-indicator">
                    <input type="number" id="pageInput" value="1" min="1">
                    <span>of <span id="totalPages">--</span></span>
                </div>

                <button class="toolbar-btn" id="nextBtn" title="Next Page">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>

            <div class="toolbar-group zoom-controls">
                <button class="toolbar-btn" id="zoomOut" title="Zoom Out">
                    <i class="fas fa-minus"></i>
                </button>
                <span id="zoomLevel">100%</span>
                <button class="toolbar-btn" id="zoomIn" title="Zoom In">
                    <i class="fas fa-plus"></i>
                </button>
            </div>

            <div class="toolbar-group">
                <button class="toolbar-btn icon-btn download-btn" id="downloadBtn" title="Download PDF">
                    <i class="fas fa-download"></i>
                </button>
                <button class="toolbar-btn icon-btn fullscreen-btn" id="fullscreenBtn" title="Fullscreen">
                    <i class="fas fa-expand"></i>
                </button>
            </div>
        </div>

        <!-- PDF Viewer Container -->
        <div class="pdf-container" id="pdfContainer">
            <div class="pdf-loading" id="pdfLoading">
                <i class="fas fa-spinner fa-spin"></i>
                <span>Loading PDF...</span>
            </div>

            <div class="pdf-error" id="pdfError" style="display: none;">
                <i class="fas fa-exclamation-circle"></i>
                <h3>PDF Not Found</h3>
                <p>Please upload the PDF file for this year.</p>
            </div>

            <!-- PDF Canvas for PDF.js rendering -->
            <canvas id="pdfCanvas"></canvas>
        </div>
    </div>

</div>

<!-- PDF.js Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>

<!-- Project Specific JS -->
<script src="{% static 'js/annual_reports.js' %}"></script>
{% endblock %}